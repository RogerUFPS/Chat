package model;

import java.rmi.registry.LocateRegistry;
import java.rmi.registry.Registry;
import java.util.ArrayList;

public class Facade implements ChatsObserver{
    private User me;
    private ChatInterface serverObj;
    private GroupChat groupchat;
    private ArrayList<PrivateChat> privateChats;
        
    public Facade(){
        groupchat = new GroupChat();
        privateChats = new ArrayList<PrivateChat>();

        String serverAddress = "localhost";
	    int serverPort = 1811;
        try {
            Registry registry = LocateRegistry.getRegistry(serverAddress, serverPort);
            serverObj = (ChatInterface) (registry.lookup("server"));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
       
    public void createUser(String name){
        this.me = new User(name);
    }

	public ChatInterface getServerObj() {
		return serverObj;
	}

	public void setServerObj(ChatInterface serverObj) {
		this.serverObj = serverObj;
	}

    public void sendMessage(String message, User receiver){
       serverObj.sendMessage(message, receiver);         
    }
    
    private void getPrivateChats() {
    	privateChats = serverObj.getPrivateChats(this.me);
    }

    @Override
    public void receiveMessage(Message m){
        this.groupchat.sendMessage(m);
    }


}
